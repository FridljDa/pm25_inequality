---
title: "age_bins"
author: "Daniel"
date: '2022-11-11'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

```{r}
total_burden_rate_dir <- here::here("data/13_total_burden_rate")
total_burden_rate_dir <- file.path(total_burden_rate_dir, "nation/nvss")

list.files(total_burden_rate_dir)
```

```{r}
total_burden_2016 <- fread(file = file.path(total_burden_rate_dir, "total_burden_2016.csv"))

total_burden_2016 <- total_burden_2016 %>%
  filter(label_cause  == "all-cause" & measure1 =="Deaths" & measure2 == "age-adjusted rate" & rural_urban_class == 666)
```

primary keys
```{r}
total_burden_2016 %>%
  group_by(min_age, Race, Hispanic.Origin,Education) %>%
  filter(n()>1)
```

```{r}
age_groups <- total_burden_2016 %>%
  dplyr::group_by(Race, Hispanic.Origin,Education) %>%
  dplyr::summarise(nbins_age = n(),
            min_ages = list(min_age),
            max_ages = list(max_age)) %>%
  arrange(nbins_age)
age_groups
```

```{r}
age_groups2 <- age_groups %>%
  mutate(Race_default = (Race == "All"),
         Hispanic.Origin_default = (Hispanic.Origin == "All Origins"),
         Education_default = (Education == "666"))

age_groups2 <- age_groups2 %>%
  group_by(Race_default, Education_default) %>%
  summarise(nbins_age = mean(nbins_age),
            min_ages = list(first(min_ages)),
            max_ages = list(first(min_ages))) %>%
  arrange(nbins_age)
age_groups2
```

```{r}
total_burden_2016_ruralty <- fread(file = file.path(total_burden_rate_dir, "total_burden_2016.csv")) %>%
  filter(label_cause  == "all-cause" & measure1 =="Deaths" & measure2 == "age-adjusted rate" & rural_urban_class == 1 & Education == "666" & Race == "All")

test <- total_burden_2016_ruralty %>%
  dplyr::group_by(Race, Hispanic.Origin,Education) %>%
  dplyr::summarise(nbins_age = n(),
            min_ages = list(min_age),
            max_ages = list(max_age)) %>%
  arrange(nbins_age)
```

